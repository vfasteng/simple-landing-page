define(["require","exports","tslib","react","modules/core/i18n","modules/clean/api_v2/noauth_client","dig-components/modal","dig-components/typography","dig-components/buttons","dig-components/menu","dig-components/text_fields","modules/clean/react/app_directory/page_template/context","dig-components/snackbar"],(function(e,t,a,n,l,r,o,d,s,i,c,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackModal=void 0,n=a.__importStar(n);var p=function(e){var t=e.currentKey,l=e.values,r=e.onSelection,o=t?l.map((function(e){return e.key})).indexOf(t):-1,c=o>=0?l[o]:l[0];return c.key!==t&&r(c.key),n.default.createElement(i.Menu.Wrapper,{className:"app-directory-feedback-modal-select",onSelection:r},(function(e){var t=e.getContentProps,r=e.getTriggerProps;return n.default.createElement(n.default.Fragment,null,n.default.createElement(s.Button,a.__assign({},r(),{className:"app-directory-feedback-modal-select__button",variant:"opacity",withDropdownIcon:!0}),n.default.createElement("div",{className:"app-directory-feedback-modal-select__content"},n.default.createElement(d.Text,{isBold:!1},c.text))),n.default.createElement(i.Menu.Content,a.__assign({},t()),n.default.createElement(i.Menu.Segment,{className:"app-directory-feedback-modal-select__list-content"},l.map((function(e){return n.default.createElement(i.Menu.SelectItem,{key:e.key,value:e.key,selected:c.key===e.key},e.text)})))))}))},m={request_app_or_feature:l.intl.formatMessage({id:"aMixzH",defaultMessage:"This app or feature would be useful…"}),bug:l.intl.formatMessage({id:"VLOw+F",defaultMessage:"I wasn’t able to connect…"}),general:l.intl.formatMessage({id:"FaO5KK",defaultMessage:"App Center would be better if…"})},g={feedbackType:"",pageId:"",feedbackBody:"",screenCapUrl:""};t.FeedbackModal=function(e){var t=e.open,i=e.onRequestClose,_=u.usePageContext(),y=_.userId,b=_.appInfos,k=n.useState(!1),M=k[0],v=k[1],E=n.useState(g),h=E[0],C=E[1],x=n.useMemo((function(){return void 0===b?[]:a.__spreadArrays(b).sort((function(e,t){return e.name.localeCompare(t.name)}))}),[b]),T=h.feedbackType&&m[h.feedbackType],B=function(){return v(!1)};n.useEffect((function(){t&&C(g)}),[t]);return o.Modal.setAppElement(document.body),n.default.createElement(n.default.Fragment,null,n.default.createElement(o.Modal,{open:t,withCloseButton:"Close",onRequestClose:i,overlayClassName:"app-directory-feedback-modal__overlay"},n.default.createElement(o.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(d.Title,null,l.intl.formatMessage({id:"X9lTXt",defaultMessage:"Share feedback with Dropbox"}))),n.default.createElement(o.Modal.Body,null,n.default.createElement("div",null),n.default.createElement("div",{className:"app-directory-feedback-modal__input-heading"},n.default.createElement(d.Text,{size:"large",isBold:!0},l.intl.formatMessage({id:"qc+cIe",defaultMessage:"What would you like to tell us about?"}))),n.default.createElement(p,{currentKey:h.feedbackType,values:[{text:l.intl.formatMessage({id:"XxlRJN",defaultMessage:"An app or feature I didn’t find"}),key:"request_app_or_feature"},{text:l.intl.formatMessage({id:"TrKcya",defaultMessage:"A problem while using App Center"}),key:"bug"},{text:l.intl.formatMessage({id:"Olh9S5",defaultMessage:"An idea for improving App Center"}),key:"general"}],onSelection:function(e){C((function(t){return a.__assign(a.__assign({},t),{feedbackType:e})}))}}),n.default.createElement("div",{className:"app-directory-feedback-modal__input-heading"},n.default.createElement(d.Text,{size:"large",isBold:!0},l.intl.formatMessage({id:"BTrvIQ",defaultMessage:"What app is this feedback about?"}))),n.default.createElement(p,{currentKey:h.pageId,values:[{text:l.intl.formatMessage({id:"Y4DjtR",defaultMessage:"None - General App Center feedback"}),key:""}].concat(x.map((function(e){return{text:e.name,key:e.pageId}}))),onSelection:function(e){C((function(t){return a.__assign(a.__assign({},t),{pageId:e})}))}}),n.default.createElement("div",{className:"app-directory-feedback-modal__input-heading"},n.default.createElement(d.Text,{size:"large",isBold:!0},l.intl.formatMessage({id:"6D/3E5",defaultMessage:"Tell us how we can help"}))),n.default.createElement(c.TextArea,{onChange:function(e){var t=e.target.value;C((function(e){return a.__assign(a.__assign({},e),{feedbackBody:t})}))},value:h.feedbackBody,placeholder:T}),n.default.createElement("div",{className:"app-directory-feedback-modal__input-heading"},n.default.createElement(d.Text,{size:"large",isBold:!0},l.intl.formatMessage({id:"QiUuMZ",defaultMessage:"Include a link to a screenshot or video"})),n.default.createElement(d.Text,{className:"app-directory-feedback-modal__input-optional",color:"faint"},l.intl.formatMessage({id:"/RQDBN",defaultMessage:"Optional"}))),n.default.createElement(c.TextInput,{wrapperProps:{className:"app-directory-feedback-modal__input"},onChange:function(e){var t=e.target.value;C((function(e){return a.__assign(a.__assign({},e),{screenCapUrl:t})}))},value:h.screenCapUrl,placeholder:l.intl.formatMessage({id:"vgeumv",defaultMessage:"Paste URL to screenshot or video"})})),n.default.createElement(o.Modal.Footer,null,n.default.createElement(s.Button,{variant:"opacity",onClick:i},l.intl.formatMessage({id:"HHw5B1",defaultMessage:"Cancel"})),n.default.createElement(s.Button,{variant:"primary",disabled:h.feedbackBody.length<1,onClick:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,(new r.NoAuthApiV2Client).ns("app_directory").rpc("submit_feedback",{user_id:y,feedback_type:h.feedbackType,page_id:h.pageId||void 0,feedback_body:h.feedbackBody,screen_cap_url:h.screenCapUrl||void 0},{})];case 1:return e.sent(),i(),v(!0),[2]}}))}))}},l.intl.formatMessage({id:"0FUoYO",defaultMessage:"Send"})))),n.default.createElement("div",{className:"app-directory-feedback-modal__snackbar-container"},n.default.createElement(f.Snackbar,{open:M,onRequestClose:B,timeout:0},n.default.createElement(f.Snackbar.Message,null,l.intl.formatMessage({id:"V7lg8n",defaultMessage:"Thank you for your feedback."})),n.default.createElement(f.Snackbar.Actions,null,n.default.createElement(s.Button,{variant:"transparent",inverse:!0,onClick:B},"Dismiss")))))}}));
//# sourceMappingURL=feedback_modal.min.js-vflMKFqG-.map