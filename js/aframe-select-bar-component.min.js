!function(t){function e(o){if(i[o])return i[o].exports;var r=i[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){"use strict";function i(t,e,i){for(var o=0;o<t.length;o+=1)if(t[o][e]===i)return o;return-1}function o(t){if(0===t.length)return-1;for(var e=t[0],i=0,o=1;o<t.length;o++)t[o]>e&&(i=o,e=t[o]);return i}function r(t,e){return t>e-1?t-e:t<0?e+t:t}function n(t,e){if(!t){if(e=e||"Assertion failed","undefined"!=typeof Error)throw new Error(e);throw e}}if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var a=[0,1,2,3,4,5,6,7,8,9];n(9==r(9,a.length)),n(0==r(10,a.length)),n(1==r(11,a.length)),n(0==r(0,a.length)),n(9==r(-1,a.length)),n(8==r(-2,a.length)),AFRAME.registerComponent("select-bar",{schema:{controls:{type:"boolean",default:!0},controllerID:{type:"string",default:"rightController"}},makeSelectOptionsRow:function(t,e,o,r,n){var a=document.createElement("a-entity");a.id=n+"optgroupLabel"+o,a.setAttribute("position","0.07 "+(.045+r)+" -0.003"),a.setAttribute("scale","0.5 0.5 0.5"),a.setAttribute("text","value",t.getAttribute("label")),a.setAttribute("text","color","#747474"),e.appendChild(a);var s=t.getElementsByTagName("option"),l=Array.prototype.slice.call(s),u=l.slice(0,4),d=l.slice(-3),m=d.concat(u),c="",p=-.225,h=.075;m.forEach(function(e,o){var a=0!==o&&6!==o,s=3===o,u=i(l,"value",e.getAttribute("value"));c+='\n      <a-entity id="'+n+u+'" visible="'+a+'" class="preview'+(s?" selected":"")+'" optionid="'+u+'" value="'+e.getAttribute("value")+'" optgroup="'+t.getAttribute("value")+'" position="'+p+" "+r+' 0">\n        <a-box class="previewFrame" position="0 0 -0.003" scale="0.06 0.06 0.005" material="color: '+(s?"yellow":"#222222")+'"></a-box>\n        <a-image class="previewImage" scale="0.05 0.05 0.05" src="'+e.getAttribute("src")+'" ></a-image>\n        <a-entity class="objectName" position="0.065 -0.04 -0.003" scale="0.18 0.18 0.18" text="value: '+e.text+"; color: "+(s?"yellow":"#747474")+'"></a-entity>\n      </a-entity>',p+=h});var v=document.createElement("a-entity");v.id=n+"selectOptionsRow"+o,v.innerHTML=c,e.appendChild(v)},init:function(){var t=this.el;this.lastTime=new Date,this.selectedOptgroupValue=null,this.selectedOptgroupIndex=0,this.selectedOptionValue=null,this.selectedOptionIndex=0,this.idPrefix=t.id?t.id:"menu";var e=document.createElement("a-entity");e.id=this.idPrefix+"selectRender",e.innerHTML='\n      <a-box id="'+this.idPrefix+'Frame" scale="0.4 0.15 0.005" position="0 0 -0.0075"  material="opacity: 0.5; transparent: true; color: #000000"></a-box>\n      <a-entity id="'+this.idPrefix+'arrowRight" position="0.225 0 0" rotation="90 180 0" scale="-0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity: 0.5; transparent: true; color: #000000"></a-entity>\n      <a-entity id="'+this.idPrefix+'arrowLeft" position="-0.225 0 0" rotation="90 180 0" scale="0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity:0.5; transparent:true; color:#000000"></a-entity>\n      <a-entity id="'+this.idPrefix+'arrowUp" position="0 0.1 0" rotation="0 270 90" scale="0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity: 0.5; transparent: true; color: #000000"></a-entity>\n      <a-entity id="'+this.idPrefix+'arrowDown" position="0 -0.1 0" rotation="0 270 90" scale="-0.004 0.002 0.004" obj-model="obj:#env_arrow" material="opacity: 0.5; transparent: true; color: #000000"></a-entity>\n      ',t.appendChild(e);var i=t.getElementsByTagName("optgroup"),o=i[this.selectedOptgroupIndex];this.selectedOptgroupValue=o.getAttribute("value"),this.makeSelectOptionsRow(o,e,this.selectedOptgroupIndex,0,this.idPrefix);var r=o.getElementsByTagName("option"),n=r[this.selectedOptionIndex];this.selectedOptionValue=n.getAttribute("value")},removeSelectOptionsRow:function(t){for(var e=document.getElementById(this.idPrefix+"selectOptionsRow"+t),i=document.getElementById(this.idPrefix+"optgroupLabel"+t);e.firstChild;)e.removeChild(e.firstChild);i.parentNode.removeChild(i),e.parentNode.removeChild(e)},addEventListeners:function(){if(this.data.controls&&this.data.controllerID){var t=document.getElementById(this.data.controllerID);t.addEventListener("trackpaddown",this.onTrackpadDown.bind(this)),t.addEventListener("axismove",this.onAxisMove.bind(this)),t.addEventListener("triggerdown",this.onTriggerDown.bind(this))}var e=this.el;e.addEventListener("onHoverLeft",this.onHoverLeft.bind(this)),e.addEventListener("onHoverRight",this.onHoverRight.bind(this)),e.addEventListener("onOptionSwitch",this.onOptionSwitch.bind(this)),e.addEventListener("onOptionNext",this.onOptionNext.bind(this)),e.addEventListener("onOptionPrevious",this.onOptionPrevious.bind(this)),e.addEventListener("onOptgroupNext",this.onOptgroupNext.bind(this)),e.addEventListener("onOptgroupPrevious",this.onOptgroupPrevious.bind(this))},removeEventListeners:function(){if(this.data.controls&&this.data.controllerID){var t=document.getElementById(this.data.controllerID);t.removeEventListener("trackpaddown",this.onTrackpadDown),t.removeEventListener("axismove",this.onAxisMove),t.removeEventListener("triggerdown",this.onTriggerDown)}var e=this.el;e.removeEventListener("onOptionSwitch",this.onOptionSwitch),e.removeEventListener("onHoverRight",this.onHoverRight),e.removeEventListener("onHoverLeft",this.onHoverLeft),e.removeEventListener("onOptionNext",this.onOptionNext),e.removeEventListener("onOptionPrevious",this.onOptionPrevious),e.removeEventListener("onOptgroupNext",this.onOptgroupNext),e.removeEventListener("onOptgroupPrevious",this.onOptgroupPrevious)},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.removeEventListeners()},onTriggerDown:function(t){t.target.id==this.data.controllerID&&this.el.emit("menuSelected")},onAxisMove:function(t){if(t.target.id==this.data.controllerID&&(0!==t.detail.axis[0]||0!==t.detail.axis[1])){var e=!1,i=navigator.getGamepads();if(i)for(var o=0;o<i.length;o++){var r=i[o];r&&0===r.id.indexOf("Oculus Touch")&&(e=!0)}if(Math.abs(t.detail.axis[0])>Math.abs(t.detail.axis[1]))t.detail.axis[0]>0?this.onHoverRight():this.onHoverLeft();else{if(e)var n=-t.detail.axis[1];else var n=t.detail.axis[1];n>0?this.onHoverUp():this.onHoverDown()}var i=navigator.getGamepads();if(i)for(var o=0;o<i.length;o++){var r=i[o];if(r&&0===r.id.indexOf("Oculus Touch")&&(Math.abs(t.detail.axis[0])>.85||Math.abs(t.detail.axis[1])>.85)){var a=new Date;return void(Math.floor(a-this.lastTime)>500&&(this.lastTime=a,this.onTrackpadDown(t)))}}}},onHoverRight:function(){this.el.emit("menuHoverRight");var t=document.getElementById(this.idPrefix+"arrowRight"),e=new THREE.Color(t.getAttribute("material").color);0===e.r&&(t.removeAttribute("animation__color"),t.removeAttribute("animation__opacity"),t.setAttribute("animation__color",{property:"material.color",dur:500,from:"#00FF00",to:"#000000"}),t.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}))},onHoverLeft:function(){this.el.emit("menuHoverLeft");var t=document.getElementById(this.idPrefix+"arrowLeft"),e=new THREE.Color(t.getAttribute("material").color);0===e.r&&(t.removeAttribute("animation__color"),t.removeAttribute("animation__opacity"),t.setAttribute("animation__color",{property:"material.color",dur:500,from:"#00FF00",to:"#000000"}),t.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}))},onHoverDown:function(){this.el.emit("menuHoverDown");var t=this.el,e=t.getElementsByTagName("optgroup"),i=document.getElementById(this.idPrefix+"arrowDown"),o=new THREE.Color(i.getAttribute("material").color);if(!(o.r>0&&o.g>0)){if(this.selectedOptgroupIndex+2>e.length)var r="#FF0000";else var r="#00FF00";i.removeAttribute("animation__color"),i.removeAttribute("animation__opacity"),i.setAttribute("animation__color",{property:"material.color",dur:500,from:r,to:"#000000"}),i.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"})}},onHoverUp:function(){this.el.emit("menuHoverUp");var t=document.getElementById(this.idPrefix+"arrowUp"),e=new THREE.Color(t.getAttribute("material").color);if(!(e.r>0&&e.g>0)){if(this.selectedOptgroupIndex-1<0)var i="#FF0000";else var i="#00FF00";t.removeAttribute("animation__color"),t.removeAttribute("animation__opacity"),t.setAttribute("animation__color",{property:"material.color",dur:500,from:i,to:"#000000"}),t.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"})}},onOptionNext:function(t){this.onOptionSwitch("next")},onOptionPrevious:function(t){this.onOptionSwitch("previous")},onOptgroupNext:function(t){var e=this.el,i=e.getElementsByTagName("optgroup"),o=document.getElementById(this.idPrefix+"selectRender");if(this.selectedOptgroupIndex+2>i.length){var r=document.getElementById(this.idPrefix+"arrowDown");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FF0000",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"-0.006 0.003 0.006",to:"-0.004 0.002 0.004"})}else{this.removeSelectOptionsRow(this.selectedOptgroupIndex),this.selectedOptgroupIndex+=1;var n=i[this.selectedOptgroupIndex];this.selectedOptgroupValue=n.getAttribute("value"),this.el.flushToDOM();var a=i[this.selectedOptgroupIndex];this.makeSelectOptionsRow(a,o,this.selectedOptgroupIndex,0,this.idPrefix);var s=document.getElementById(this.idPrefix+"selectOptionsRow"+this.selectedOptgroupIndex),l=s.getElementsByClassName("selected")[0];this.selectedOptionValue=l.getAttribute("value"),this.selectedOptionIndex=l.getAttribute("optionid"),this.el.flushToDOM(),this.el.emit("menuOptgroupNext"),this.el.emit("menuChanged");var r=document.getElementById(this.idPrefix+"arrowDown");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"-0.006 0.003 0.006",to:"-0.004 0.002 0.004"})}},onOptgroupPrevious:function(t){var e=this.el,i=e.getElementsByTagName("optgroup"),o=document.getElementById(this.idPrefix+"selectRender");if(this.selectedOptgroupIndex-1<0){var r=document.getElementById(this.idPrefix+"arrowUp");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FF0000",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"0.006 0.003 0.006",to:"0.004 0.002 0.004"})}else{this.removeSelectOptionsRow(this.selectedOptgroupIndex),this.selectedOptgroupIndex-=1;var n=i[this.selectedOptgroupIndex];this.selectedOptgroupValue=n.getAttribute("value"),this.el.flushToDOM();var a=i[this.selectedOptgroupIndex];this.makeSelectOptionsRow(a,o,this.selectedOptgroupIndex,0,this.idPrefix);var s=document.getElementById(this.idPrefix+"selectOptionsRow"+this.selectedOptgroupIndex),l=s.getElementsByClassName("selected")[0];this.selectedOptionValue=l.getAttribute("value"),this.selectedOptionIndex=l.getAttribute("optionid"),this.el.flushToDOM(),this.el.emit("menuOptgroupNext"),this.el.emit("menuChanged");var r=document.getElementById(this.idPrefix+"arrowUp");r.removeAttribute("animation__color"),r.removeAttribute("animation__opacity"),r.removeAttribute("animation__scale"),r.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),r.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),r.setAttribute("animation__scale",{property:"scale",dur:500,from:"0.006 0.003 0.006",to:"0.004 0.002 0.004"})}},onTrackpadDown:function(t){if(t.target.id==this.data.controllerID){var e=new THREE.Color(document.getElementById(this.idPrefix+"arrowUp").getAttribute("material").color),i=new THREE.Color(document.getElementById(this.idPrefix+"arrowRight").getAttribute("material").color),r=new THREE.Color(document.getElementById(this.idPrefix+"arrowDown").getAttribute("material").color),n=new THREE.Color(document.getElementById(this.idPrefix+"arrowLeft").getAttribute("material").color),a=[e.g,i.g,r.g,n.g];if(a.reduce(function(t,e){return t+e},0)>0)switch(o(a)){case 0:return void this.onOptgroupPrevious();case 1:return void this.onOptionSwitch("next");case 2:return void this.onOptgroupNext();case 3:return void this.onOptionSwitch("previous")}}},onOptionSwitch:function(t){var e=document.getElementById(this.idPrefix+"selectOptionsRow"+this.selectedOptgroupIndex),i=e.getElementsByClassName("selected")[0],o=parseInt(i.getAttribute("optionid")),n=o,a=this.el,s=a.getElementsByTagName("optgroup"),l=s[this.selectedOptgroupIndex];if("previous"==t){this.el.emit("menuPrevious"),n=r(n-=1,l.childElementCount);var u=document.getElementById(this.idPrefix+"arrowLeft");u.removeAttribute("animation__color"),u.removeAttribute("animation__opacity"),u.removeAttribute("animation__scale"),u.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),u.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),u.setAttribute("animation__scale",{property:"scale",dur:500,from:"0.006 0.003 0.006",to:"0.004 0.002 0.004"});var d=e.querySelectorAll("[optionid='"+n+"']")[0];if(i.classList.remove("selected"),d.classList.add("selected"),this.selectedOptionValue=d.getAttribute("value"),console.log(this.selectedOptionValue),this.selectedOptionIndex=n,this.el.flushToDOM(),this.el.emit("menuChanged"),i.getElementsByClassName("objectName")[0].setAttribute("text","color","gray"),d.getElementsByClassName("objectName")[0].setAttribute("text","color","yellow"),i.getElementsByClassName("previewFrame")[0].setAttribute("material","color","#222222"),d.getElementsByClassName("previewFrame")[0].setAttribute("material","color","yellow"),e.hasAttribute("desiredPosition"))var m=e.getAttribute("desiredPosition"),c=parseFloat(m.split(" ")[0])+.075,p=c.toString()+" "+m.split(" ")[1]+" "+m.split(" ")[2];else var m=e.object3D.position,c=m.x+.075,p=c.toString()+" "+m.y+" "+m.z;e.removeAttribute("animation__slide"),e.setAttribute("animation__slide",{property:"position",dur:500,from:m,to:p}),e.setAttribute("desiredPosition",p);var h=r(o-3,l.childElementCount),v=e.querySelectorAll("[optionid='"+h+"']")[0];v.setAttribute("visible","true"),v.removeAttribute("animation"),v.setAttribute("animation",{property:"scale",dur:500,from:"0.5 0.5 0.5",to:"1.0 1.0 1.0"}),v.flushToDOM();var g=r(o+3,l.childElementCount),b=e.querySelectorAll("[optionid='"+g+"']")[0];b.flushToDOM(),b.parentNode.removeChild(b);var f=r(o+2,l.childElementCount),y=e.querySelectorAll("[optionid='"+f+"']")[0];y.setAttribute("visible","false"),y.flushToDOM();var A=v.cloneNode(!0);A.setAttribute("visible","false");var x=r(o-4,l.childElementCount),_=l.children[x];A.setAttribute("optionid",x),A.setAttribute("id",this.idPrefix+x),A.setAttribute("value",_.getAttribute("value"));var E=v.object3D.position;A.setAttribute("position",E.x-.075+" "+E.y+" "+E.z),A.flushToDOM(),e.insertBefore(A,e.firstChild);var O=e.querySelectorAll("[optionid='"+x+"']")[0];O.getElementsByClassName("previewImage")[0].setAttribute("src",_.getAttribute("src")),O.getElementsByClassName("objectName")[0].setAttribute("text","value",_.text),O.getElementsByClassName("objectName")[0].setAttribute("text","color","#747474"),O.flushToDOM()}else{this.el.emit("menuNext"),n=r(n+=1,l.childElementCount);var w=document.getElementById(this.idPrefix+"arrowRight");w.removeAttribute("animation__color"),w.removeAttribute("animation__opacity"),w.removeAttribute("animation__scale"),w.setAttribute("animation__color",{property:"material.color",dur:500,from:"#FFFF00",to:"#000000"}),w.setAttribute("animation__opacity",{property:"material.opacity",dur:500,from:"1",to:"0.5"}),w.setAttribute("animation__scale",{property:"scale",dur:500,from:"-0.006 0.003 0.006",to:"-0.004 0.002 0.004"});var I=e.querySelectorAll("[optionid='"+n+"']")[0];if(i.classList.remove("selected"),I.classList.add("selected"),this.selectedOptionValue=I.getAttribute("value"),this.selectedOptionIndex=n,this.el.flushToDOM(),this.el.emit("menuChanged"),i.getElementsByClassName("objectName")[0].setAttribute("text","color","gray"),I.getElementsByClassName("objectName")[0].setAttribute("text","color","yellow"),i.getElementsByClassName("previewFrame")[0].setAttribute("material","color","#222222"),I.getElementsByClassName("previewFrame")[0].setAttribute("material","color","yellow"),e.hasAttribute("desiredPosition"))var m=e.getAttribute("desiredPosition"),c=parseFloat(m.split(" ")[0])-.075,p=c.toString()+" "+m.split(" ")[1]+" "+m.split(" ")[2];else var m=e.object3D.position,c=m.x-.075,p=c.toString()+" "+m.y+" "+m.z;e.removeAttribute("animation__slide"),e.setAttribute("animation__slide",{property:"position",dur:500,from:m,to:p}),e.setAttribute("desiredPosition",p);var h=r(o+3,l.childElementCount),v=e.querySelectorAll("[optionid='"+h+"']")[0];v.setAttribute("visible","true"),v.removeAttribute("animation"),v.setAttribute("animation",{property:"scale",dur:500,from:"0.5 0.5 0.5",to:"1.0 1.0 1.0"}),v.flushToDOM();var g=r(o-3,l.childElementCount),b=e.querySelectorAll("[optionid='"+g+"']")[0];b.flushToDOM(),b.parentNode.removeChild(b);var f=r(o-2,l.childElementCount),y=e.querySelectorAll("[optionid='"+f+"']")[0];y.setAttribute("visible","false"),y.flushToDOM();var A=v.cloneNode(!0);A.setAttribute("visible","false");var x=r(o+4,l.childElementCount),_=l.children[x];A.setAttribute("optionid",x),A.setAttribute("id",this.idPrefix+x),A.setAttribute("value",_.getAttribute("value"));var E=v.object3D.position;A.setAttribute("position",E.x+.075+" "+E.y+" "+E.z),A.flushToDOM(),e.insertBefore(A,e.firstChild);var O=e.querySelectorAll("[optionid='"+x+"']")[0];O.getElementsByClassName("previewImage")[0].setAttribute("src",_.getAttribute("src")),O.getElementsByClassName("objectName")[0].setAttribute("text","value",_.text),O.getElementsByClassName("objectName")[0].setAttribute("text","color","#747474"),O.flushToDOM()}}})}]);